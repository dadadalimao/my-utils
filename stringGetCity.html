<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æå–çœå¸‚åŒºå¿</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      line-height: 1.6;
      padding: 20px;
    }

    pre {
      background: #f4f4f4;
      padding: 10px;
      border-left: 4px solid #ccc;
      overflow-x: auto;
    }
  </style>
</head>

<body>
  <h1>æå–åœ°å€ä¸­çš„çœã€å¸‚ã€åŒº/å¿</h1>
  <p>è¾“å…¥åœ°å€å¹¶è§£æå…¶ä¸­çš„çœã€å¸‚ã€åŒº/å¿ã€‚</p>

  <textarea id="inputAddress" rows="5" cols="50" placeholder="è¯·è¾“å…¥åœ°å€"></textarea>
  <br><br>
  <button id="extractButton">æå–çœå¸‚åŒºå¿</button>

  <h2>æå–ç»“æœ</h2>
  <pre id="output"></pre>

  <script>
    // çœã€å¸‚ã€åŒº/å¿çš„æ­£åˆ™æ¨¡å¼
    const patterns = {
      province: /([\u4e00-\u9fa5]{2,}(çœ|è‡ªæ²»åŒº|ç‰¹åˆ«è¡Œæ”¿åŒº))/,
      city: /([\u4e00-\u9fa5]{2,}(å¸‚|è‡ªæ²»å·|åœ°åŒº|ç›Ÿ))/,
      district: /([\u4e00-\u9fa5]{2,}(åŒº|å¿|æ——|å¸‚è¾–åŒº|è‡ªæ²»å¿|æ—åŒº))/,
    };

    /**
     * æå–åœ°å€ä¸­çš„çœã€å¸‚ã€åŒº/å¿
     * @param {string} address - è¾“å…¥çš„åœ°å€å­—ç¬¦ä¸²
     * @returns {Object} - åŒ…å«æå–çš„çœã€å¸‚ã€åŒºå¿å’Œè¯¦ç»†åœ°å€
     */
    function extractAddress(address) {
      let result = {
        province: null,
        city: null,
        district: null,
        detail: address, // é»˜è®¤æ•´ä¸ªè¾“å…¥ä½œä¸ºè¯¦ç»†åœ°å€
      };

      // æå–çœ
      const provinceMatch = address.match(patterns.province);
      console.log("ğŸš€ ~ extractAddress ~ provinceMatch:", provinceMatch)
      if (provinceMatch) {
        result.province = provinceMatch[1];
        address = address.replace(provinceMatch[0], ''); // å»é™¤åŒ¹é…çš„çœ
      }

      // æå–å¸‚
      const cityMatch = address.match(patterns.city);
      console.log("ğŸš€ ~ extractAddress ~ cityMatch:", cityMatch)
      if (cityMatch) {
        result.city = cityMatch[1];
        address = address.replace(cityMatch[0], ''); // å»é™¤åŒ¹é…çš„å¸‚
      }

      // æå–åŒº/å¿
      const districtMatch = address.match(patterns.district);
      console.log("ğŸš€ ~ extractAddress ~ districtMatch:", districtMatch)
      if (districtMatch) {
        result.district = districtMatch[1];
        address = address.replace(districtMatch[0], ''); // å»é™¤åŒ¹é…çš„åŒº/å¿
      }

      // å‰©ä¸‹çš„éƒ¨åˆ†ä½œä¸ºè¯¦ç»†åœ°å€
      result.detail = address.trim();

      // å¤„ç†ç‰¹æ®Šæƒ…å†µï¼šé‡å¤ä¿¡æ¯
      if (result.city && result.city.includes(result.province)) {
        result.city = result.city.replace(result.province, '').trim();
      }

      return result;
    }

    // æŒ‰é’®ç‚¹å‡»äº‹ä»¶ç»‘å®š
    document.getElementById('extractButton').addEventListener('click', () => {
      const inputAddress = document.getElementById('inputAddress').value.trim();
      if (!inputAddress) {
        document.getElementById('output').textContent = 'è¯·è¾“å…¥æœ‰æ•ˆçš„åœ°å€ï¼';
        return;
      }

      const result = extractAddress(inputAddress);
      document.getElementById('output').textContent = JSON.stringify(result, null, 2);
    });
  </script>
</body>

</html>