<!DOCTYPE html>
<html lang="zh">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>WordËΩ¨HTML</title>

  <!-- ÂºïÂÖ• mammoth.js Â∫ì -->
  <script src="js/mammoth.browser.min.js"></script>
  <script src="js/mammoth.config.js"></script>
  <!-- ÂºïÂÖ• FileSaver.js Â∫ì -->
  <script src="js/FileSaver2.0.5.js"></script>
  <!-- ÂºïÂÖ•Áªü‰∏ÄÂØºËà™Ê†è -->
  <script src="nav.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }

    #output {
      margin-top: 20px;
    }

    #dropZone {
      border: 2px dashed #ccc;
      padding: 40px;
      text-align: center;
      margin: 20px 0;
      background-color: #fafafa;
      transition: all 0.3s ease;
      cursor: pointer;
    }

    #dropZone.dragover {
      background-color: #e1f5fe;
      border-color: #2196f3;
    }

    #fileInput {
      display: none;
    }

    .upload-text {
      font-size: 18px;
      color: #666;
      margin-bottom: 10px;
    }

    .upload-icon {
      font-size: 48px;
      color: #999;
      margin-bottom: 10px;
    }

    #convertButton {
      padding: 10px 20px;
      background-color: #2196f3;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 16px;
      transition: background-color 0.3s ease;
    }

    #convertButton:hover {
      background-color: #1976d2;
    }
  </style>
</head>

<body>
  <h1>WordËΩ¨HTML</h1>
  <div id="dropZone">
    <div class="upload-icon">üìÑ</div>
    <div class="upload-text">ÊãñÊîæWordÊñá‰ª∂Âà∞ËøôÈáå Êàñ ÁÇπÂáªÈÄâÊã©Êñá‰ª∂</div>
    <input type="file" id="fileInput" accept=".docx">
  </div>
  <button id="convertButton">ËΩ¨Êç¢Âπ∂‰∏ãËΩΩ</button>
  <div id="output"></div>

  <script>
    // Ê∑ªÂä†ÊãñÊîæ‰∫ã‰ª∂Â§ÑÁêÜ
    const dropZone = document.getElementById('dropZone');
    const fileInput = document.getElementById('fileInput');

    // ÁÇπÂáª‰∏ä‰º†Âå∫ÂüüËß¶ÂèëÊñá‰ª∂ÈÄâÊã©
    dropZone.addEventListener('click', () => {
      fileInput.click();
    });

    // Êñá‰ª∂ÈÄâÊã©ÂèòÂåñÊó∂Êõ¥Êñ∞ÊòæÁ§∫
    fileInput.addEventListener('change', () => {
      if (fileInput.files.length > 0) {
        dropZone.querySelector('.upload-text').textContent = `Â∑≤ÈÄâÊã©: ${fileInput.files[0].name}`;
      }
    });

    dropZone.addEventListener('dragover', (e) => {
      e.preventDefault();
      dropZone.classList.add('dragover');
    });

    dropZone.addEventListener('dragleave', () => {
      dropZone.classList.remove('dragover');
    });

    dropZone.addEventListener('drop', (e) => {
      e.preventDefault();
      dropZone.classList.remove('dragover');
      const files = e.dataTransfer.files;
      if (files.length > 0) {
        fileInput.files = files;
        dropZone.querySelector('.upload-text').textContent = `Â∑≤ÈÄâÊã©: ${files[0].name}`;
      }
    });

    document.getElementById('convertButton').addEventListener('click', function () {
      const fileInput = document.getElementById('fileInput');
      const file = fileInput.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function (event) {
          const arrayBuffer = event.target.result;
          mammoth.convertToHtml({ arrayBuffer: arrayBuffer }, options)
            .then(function (result) {
              const htmlContent = result.value;
              const fullHtmlContent = `&lt;!DOCTYPE html&gt;
&lt;html lang="zh"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
    &lt;title&gt;${docTitle || 'doc'}&lt;/title&gt;
    &lt;style&gt;
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        ol {
            padding-inline-start: 12px;
        }
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            line-height: 1.6;
            color: #333;
        }
        p, h1, h2, h3, h4, h5, h6 {
            line-height: 1.5;
            margin: 10px 0;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            margin: 15px 0;
        }
        th, td {
            padding: 8px;
            border: 1px solid #ddd;
        }
        th {
            background-color: #f5f5f5;
        }
        ul, ol {
            margin: 10px 0 10px 20px;
        }
        li {
            margin-bottom: 5px;
        }
        img {
            max-width: 100%;
            height: auto;
            margin: 10px 0;
        }
        .title {
            text-align: center;
            font-size: 32px;
            font-weight: bold;
        }

        @media screen and (max-width: 768px) {
            .title {
                font-size: 24px;
            }
        }
        /* Ë°•ÂÖÖQuillÊ†∑Âºè */
        .ql-align-center {
            text-align: center;
        }
        .ql-align-right {
            text-align: right;
        }
        .ql-align-justify {
            text-align: justify;
        }
        .ql-bold {
            font-weight: bold;
        }
        .ql-italic {
            font-style: italic;
        }
        .ql-underline {
            text-decoration: underline;
        }
        .ql-strike {
            text-decoration: line-through;
        }
    &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
    ${htmlContent}
&lt;/body&gt;
&lt;/html&gt;`;

              // Âú®‰øùÂ≠ò‰πãÂâçËß£Á†ÅHTMLÂÆû‰Ωì
              const decodedContent = fullHtmlContent
                .replace(/&lt;/g, '<')
                .replace(/&gt;/g, '>');

              const blob = new Blob([decodedContent], { type: 'text/html;charset=utf-8' });
              saveAs(blob, `${docTitle || 'doc'}.html`);
            })
            .catch(function (err) {
              console.error(err);
              alert('ËΩ¨Êç¢Â§±Ë¥•ÔºåËØ∑Ê£ÄÊü•Êñá‰ª∂Ê†ºÂºèÊàñÈáçËØï„ÄÇ');
            });
        };
        reader.readAsArrayBuffer(file);
      } else {
        alert('ËØ∑ÈÄâÊã©‰∏Ä‰∏™WordÊñá‰ª∂„ÄÇ');
      }
    });
  </script>
</body>

</html>